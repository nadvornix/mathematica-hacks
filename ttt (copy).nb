(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     23092,        603]
NotebookOptionsPosition[     22326,        573]
NotebookOutlinePosition[     22683,        589]
CellTagsIndexPosition[     22640,        586]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"x", "=", "3"}], "\[IndentingNewLine]", 
 RowBox[{"y", "=", "3"}], "\[IndentingNewLine]", 
 RowBox[{"s", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Thick", ",", "Gray"}], "}"}], "~", "Join", "~", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "i"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "i"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "x"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"grid", "=", 
  RowBox[{"%", "~", "Join", "~", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "x"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "y"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "[", "s1_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"s1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1_", "?", "NumericQ"}], ",", "y1_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"Thickness", "\[Rule]", "0.04"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "-", ".8"}], ",", 
              RowBox[{"y1", "-", ".8"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "-", ".2"}], ",", 
              RowBox[{"y1", "-", ".2"}]}], "}"}]}], "}"}], "]"}], ",", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "-", ".2"}], ",", 
              RowBox[{"y1", "-", ".8"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "-", ".8"}], ",", 
              RowBox[{"y1", "-", ".2"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1_", "?", "NumericQ"}], ",", "y1_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Thickness", "\[Rule]", "0.04"}], ",", 
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x1", "-", ".5"}], ",", 
             RowBox[{"y1", "-", ".5"}]}], "}"}], ",", "0.4"}], "]"}]}], 
        "}"}]}]}]}], "}"}], "//", "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextMove", "[", "s1_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "~", "Append", "~", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1Move", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"s", ",", 
       RowBox[{"Ceiling", "@", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1"}], "}"}]}], ",", "Infinity"}], "]"}]}], ",", 
    
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"Ceiling", "@", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1"}], "}"}]}]}], "]"}], ";", 
     RowBox[{"nextMove", "[", "s", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"winpos", "[", "q_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}], "~", "Join", 
       "~", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"winposs", "=", 
      RowBox[{"a", "~", "Join", "~", 
       RowBox[{"Transpose", "@", "a"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Intersection", "[", 
             RowBox[{"q", ",", "#"}], "]"}]}], "\[Equal]", "3"}], ")"}], 
         "&"}], "/@", "winposs"}], ")"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"winner", "[", "q_", "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"winpos", "[", 
     RowBox[{"q", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1", ",", 
    RowBox[{"winpos", "[", 
     RowBox[{"q", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
    RowBox[{"-", "1"}], ",", "True", ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pt", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"ClickPane", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"grid", "~", "Join", "~", 
         RowBox[{"z", "[", "s", "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
     "p1Move"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.561518662623654*^9, 3.561518669177862*^9}, {
   3.5615225462208242`*^9, 3.5615225664012547`*^9}, {3.5615226052835608`*^9, 
   3.561522818270226*^9}, {3.561522849221187*^9, 3.561523030204288*^9}, {
   3.561523083343487*^9, 3.561523178444894*^9}, {3.561523208784285*^9, 
   3.561523368214361*^9}, {3.5615234434999847`*^9, 3.561523493026523*^9}, {
   3.561523579294549*^9, 3.561523612211685*^9}, {3.561523671111462*^9, 
   3.561523920912154*^9}, {3.561523990107657*^9, 3.561524033559944*^9}, {
   3.5615242430232487`*^9, 3.561524250617367*^9}, {3.561524898618512*^9, 
   3.5615249343247433`*^9}, {3.561525041813403*^9, 3.561525087393971*^9}, {
   3.561525120246293*^9, 3.561525123957077*^9}, {3.5615252245099297`*^9, 
   3.561525361162896*^9}, {3.561525392139762*^9, 3.5615256856311626`*^9}, {
   3.561526869376828*^9, 3.561526872264185*^9}, {3.561527017291551*^9, 
   3.561527017755971*^9}, {3.561527451966659*^9, 3.561527522393339*^9}, {
   3.5620698149802313`*^9, 3.5620698159108143`*^9}, 3.562075510726274*^9}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.561522698099374*^9, 3.561522748505287*^9}, 
   3.561522778509351*^9, 3.561522818863072*^9, {3.561522878781762*^9, 
   3.56152303065724*^9}, {3.561523119261736*^9, 3.561523178933114*^9}, {
   3.561523215617934*^9, 3.561523229676126*^9}, 3.5615232875721807`*^9, 
   3.5615233278084993`*^9, {3.561523359175386*^9, 3.56152336890145*^9}, {
   3.5615235829285088`*^9, 3.561523613202641*^9}, {3.5615236732154016`*^9, 
   3.561523693179035*^9}, {3.5615237464051847`*^9, 3.561523794454398*^9}, {
   3.561523909315289*^9, 3.561523921538228*^9}, 3.561523987532185*^9, {
   3.561524020748088*^9, 3.56152403202851*^9}, 3.5615249351283293`*^9, 
   3.561524972288414*^9, 3.561525009893766*^9, 3.5615250444545527`*^9, {
   3.561525088675749*^9, 3.5615251074112387`*^9}, {3.561525259964468*^9, 
   3.561525282092073*^9}, 3.561525322768499*^9, {3.5615253536682253`*^9, 
   3.56152537032524*^9}, {3.5615254539188128`*^9, 3.561525531356135*^9}, {
   3.561525620584434*^9, 3.561525629037417*^9}, 3.561525687819056*^9, 
   3.5615267387205877`*^9, 3.5615275194931602`*^9, {3.562069799842175*^9, 
   3.562069807634391*^9}, 3.5620698934014072`*^9, 3.562069974202352*^9, 
   3.562071990019384*^9, 3.562075511669402*^9}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.561522698099374*^9, 3.561522748505287*^9}, 
   3.561522778509351*^9, 3.561522818863072*^9, {3.561522878781762*^9, 
   3.56152303065724*^9}, {3.561523119261736*^9, 3.561523178933114*^9}, {
   3.561523215617934*^9, 3.561523229676126*^9}, 3.5615232875721807`*^9, 
   3.5615233278084993`*^9, {3.561523359175386*^9, 3.56152336890145*^9}, {
   3.5615235829285088`*^9, 3.561523613202641*^9}, {3.5615236732154016`*^9, 
   3.561523693179035*^9}, {3.5615237464051847`*^9, 3.561523794454398*^9}, {
   3.561523909315289*^9, 3.561523921538228*^9}, 3.561523987532185*^9, {
   3.561524020748088*^9, 3.56152403202851*^9}, 3.5615249351283293`*^9, 
   3.561524972288414*^9, 3.561525009893766*^9, 3.5615250444545527`*^9, {
   3.561525088675749*^9, 3.5615251074112387`*^9}, {3.561525259964468*^9, 
   3.561525282092073*^9}, 3.561525322768499*^9, {3.5615253536682253`*^9, 
   3.56152537032524*^9}, {3.5615254539188128`*^9, 3.561525531356135*^9}, {
   3.561525620584434*^9, 3.561525629037417*^9}, 3.561525687819056*^9, 
   3.5615267387205877`*^9, 3.5615275194931602`*^9, {3.562069799842175*^9, 
   3.562069807634391*^9}, 3.5620698934014072`*^9, 3.562069974202352*^9, 
   3.562071990019384*^9, 3.5620755116718063`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.561522698099374*^9, 3.561522748505287*^9}, 
   3.561522778509351*^9, 3.561522818863072*^9, {3.561522878781762*^9, 
   3.56152303065724*^9}, {3.561523119261736*^9, 3.561523178933114*^9}, {
   3.561523215617934*^9, 3.561523229676126*^9}, 3.5615232875721807`*^9, 
   3.5615233278084993`*^9, {3.561523359175386*^9, 3.56152336890145*^9}, {
   3.5615235829285088`*^9, 3.561523613202641*^9}, {3.5615236732154016`*^9, 
   3.561523693179035*^9}, {3.5615237464051847`*^9, 3.561523794454398*^9}, {
   3.561523909315289*^9, 3.561523921538228*^9}, 3.561523987532185*^9, {
   3.561524020748088*^9, 3.56152403202851*^9}, 3.5615249351283293`*^9, 
   3.561524972288414*^9, 3.561525009893766*^9, 3.5615250444545527`*^9, {
   3.561525088675749*^9, 3.5615251074112387`*^9}, {3.561525259964468*^9, 
   3.561525282092073*^9}, 3.561525322768499*^9, {3.5615253536682253`*^9, 
   3.56152537032524*^9}, {3.5615254539188128`*^9, 3.561525531356135*^9}, {
   3.561525620584434*^9, 3.561525629037417*^9}, 3.561525687819056*^9, 
   3.5615267387205877`*^9, 3.5615275194931602`*^9, {3.562069799842175*^9, 
   3.562069807634391*^9}, 3.5620698934014072`*^9, 3.562069974202352*^9, 
   3.562071990019384*^9, 3.5620755116743917`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
   RowBox[{"GrayLevel", "[", "0.5`", "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], "}"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.561522698099374*^9, 3.561522748505287*^9}, 
   3.561522778509351*^9, 3.561522818863072*^9, {3.561522878781762*^9, 
   3.56152303065724*^9}, {3.561523119261736*^9, 3.561523178933114*^9}, {
   3.561523215617934*^9, 3.561523229676126*^9}, 3.5615232875721807`*^9, 
   3.5615233278084993`*^9, {3.561523359175386*^9, 3.56152336890145*^9}, {
   3.5615235829285088`*^9, 3.561523613202641*^9}, {3.5615236732154016`*^9, 
   3.561523693179035*^9}, {3.5615237464051847`*^9, 3.561523794454398*^9}, {
   3.561523909315289*^9, 3.561523921538228*^9}, 3.561523987532185*^9, {
   3.561524020748088*^9, 3.56152403202851*^9}, 3.5615249351283293`*^9, 
   3.561524972288414*^9, 3.561525009893766*^9, 3.5615250444545527`*^9, {
   3.561525088675749*^9, 3.5615251074112387`*^9}, {3.561525259964468*^9, 
   3.561525282092073*^9}, 3.561525322768499*^9, {3.5615253536682253`*^9, 
   3.56152537032524*^9}, {3.5615254539188128`*^9, 3.561525531356135*^9}, {
   3.561525620584434*^9, 3.561525629037417*^9}, 3.561525687819056*^9, 
   3.5615267387205877`*^9, 3.5615275194931602`*^9, {3.562069799842175*^9, 
   3.562069807634391*^9}, 3.5620698934014072`*^9, 3.562069974202352*^9, 
   3.562071990019384*^9, 3.562075511677681*^9}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`pt$$ = {0, 0}}, 
  TagBox[
   DynamicBox[ToBoxes[
     Graphics[
      Join[$CellContext`grid, 
       $CellContext`z[$CellContext`s]], ImageSize -> 300], StandardForm],
    ImageSizeCache->{300., {148., 152.}}],
   EventHandlerTag[{"MouseClicked" :> $CellContext`p1Move[
       MousePosition["EventHandlerAutomatic"]], PassEventsDown -> Automatic, 
     PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.561522698099374*^9, 3.561522748505287*^9}, 
   3.561522778509351*^9, 3.561522818863072*^9, {3.561522878781762*^9, 
   3.56152303065724*^9}, {3.561523119261736*^9, 3.561523178933114*^9}, {
   3.561523215617934*^9, 3.561523229676126*^9}, 3.5615232875721807`*^9, 
   3.5615233278084993`*^9, {3.561523359175386*^9, 3.56152336890145*^9}, {
   3.5615235829285088`*^9, 3.561523613202641*^9}, {3.5615236732154016`*^9, 
   3.561523693179035*^9}, {3.5615237464051847`*^9, 3.561523794454398*^9}, {
   3.561523909315289*^9, 3.561523921538228*^9}, 3.561523987532185*^9, {
   3.561524020748088*^9, 3.56152403202851*^9}, 3.5615249351283293`*^9, 
   3.561524972288414*^9, 3.561525009893766*^9, 3.5615250444545527`*^9, {
   3.561525088675749*^9, 3.5615251074112387`*^9}, {3.561525259964468*^9, 
   3.561525282092073*^9}, 3.561525322768499*^9, {3.5615253536682253`*^9, 
   3.56152537032524*^9}, {3.5615254539188128`*^9, 3.561525531356135*^9}, {
   3.561525620584434*^9, 3.561525629037417*^9}, 3.561525687819056*^9, 
   3.5615267387205877`*^9, 3.5615275194931602`*^9, {3.562069799842175*^9, 
   3.562069807634391*^9}, 3.5620698934014072`*^9, 3.562069974202352*^9, 
   3.562071990019384*^9, 3.562075511681816*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"s", "\[IndentingNewLine]", 
 RowBox[{"winner", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.5615263012710867`*^9, 3.5615263359356747`*^9}, {
   3.5615264116985064`*^9, 3.56152664517107*^9}, {3.561526709416115*^9, 
   3.561527012846712*^9}, 3.56206983003977*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.561527000994733*^9, 3.56152700336306*^9}, {
   3.562069800307046*^9, 3.562069845380825*^9}, 3.562069893986424*^9, 
   3.562069974775833*^9, 3.562071990473322*^9, 3.562075515553919*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.561527000994733*^9, 3.56152700336306*^9}, {
   3.562069800307046*^9, 3.562069845380825*^9}, 3.562069893986424*^9, 
   3.562069974775833*^9, 3.562071990473322*^9, 3.56207551555634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "posNextS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posMoves", "[", "s1_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", "1"}], "]"}], "~", 
   "Complement", "~", 
   RowBox[{"Flatten", "[", 
    RowBox[{"s1", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addMove", "[", 
   RowBox[{"s1_", ",", " ", "ja_", ",", " ", "move_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s2", "}"}], ",", 
    RowBox[{
     RowBox[{"s2", "=", "s1"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{"ja", ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"s2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "move"}], "]"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"s2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "move"}], "]"}]}], "]"}], ";", 
     "s2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posNextS", "[", 
   RowBox[{"s1_", ",", "ja_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"addMove", "[", 
     RowBox[{"s1", ",", "ja", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"posMoves", "[", "s1", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pick", "[", 
   RowBox[{"l_", ",", "minmax_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "m"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"f", "[", "#", "]"}]}], "}"}], "&"}], "/@", "l"}]}], ";", 
     RowBox[{"m", "=", 
      RowBox[{"minmax", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "tmp"}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
     RowBox[{"Cases", "[", 
      RowBox[{"tmp", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q_", ",", "m"}], "}"}], "\[Rule]", "q"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hodn", "[", 
   RowBox[{"s1_", ",", "ja_"}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"winner", "[", "s1", "]"}], ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "0", ",", "5"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"hodn", "[", 
  RowBox[{"s", ",", "True"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.561526646922277*^9, 3.561526705336388*^9}, {
  3.561528373368181*^9, 3.561528532076949*^9}, {3.561528925813294*^9, 
  3.561528946490244*^9}, {3.561529049522686*^9, 3.5615291183000593`*^9}, {
  3.561529173771179*^9, 3.5615292078395777`*^9}, {3.5615294351826773`*^9, 
  3.561529493421105*^9}, {3.5620699469996023`*^9, 3.562069982107389*^9}, {
  3.5620701813993196`*^9, 3.562070312978133*^9}, {3.5620731736291437`*^9, 
  3.56207318490244*^9}, {3.5620745062294416`*^9, 3.56207459514745*^9}, {
  3.5620747195295877`*^9, 3.562075034875923*^9}, {3.562075088720261*^9, 
  3.562075176999296*^9}, {3.562075460483149*^9, 3.5620754897796307`*^9}, {
  3.562075526172985*^9, 3.5620755570060596`*^9}, {3.562075596618198*^9, 
  3.5620756779402447`*^9}, {3.562075909526904*^9, 3.5620759310261097`*^9}, {
  3.5620759661837683`*^9, 3.562075968736483*^9}, {3.562076233584745*^9, 
  3.562076240328195*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.5620762343796577`*^9, 3.562076241791252*^9}}]
}, Open  ]]
},
WindowSize->{1366, 693},
WindowMargins->{{1, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 7956, 229, 373, "Input"],
Cell[8538, 253, 1244, 17, 30, "Output"],
Cell[9785, 272, 1246, 17, 30, "Output"],
Cell[11034, 291, 1664, 33, 30, "Output"],
Cell[12701, 326, 2994, 77, 50, "Output"],
Cell[15698, 405, 1680, 28, 315, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17415, 438, 281, 4, 50, "Input"],
Cell[17699, 444, 653, 19, 30, "Output"],
Cell[18355, 465, 234, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18626, 473, 3585, 94, 164, "Input"],
Cell[22214, 569, 96, 1, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
